<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM Capabilities Test Page - 100xBot</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 { color: #333; border-bottom: 3px solid #007bff; padding-bottom: 10px; }
        h2 { color: #555; margin-top: 40px; border-left: 4px solid #007bff; padding-left: 10px; }
        h3 { color: #666; margin-top: 20px; }
        section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .component-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 15px 0;
        }
        .component {
            flex: 1;
            min-width: 250px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #444;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        .btn-primary { background: #007bff; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        [contenteditable] {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
            min-height: 60px;
            background: white;
        }
        [contenteditable]:focus {
            outline: none;
            border-color: #007bff;
        }
        .event-log {
            background: #1e1e1e;
            color: #0f0;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            height: 100px;
            overflow-y: auto;
            border-radius: 4px;
            margin-top: 10px;
        }
        .readonly { background: #e9ecef; }
        .disabled { opacity: 0.6; }
        .autocomplete-wrapper { position: relative; }
        .autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 4px 4px;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            z-index: 100;
        }
        .autocomplete-list.show { display: block; }
        .autocomplete-item {
            padding: 10px;
            cursor: pointer;
        }
        .autocomplete-item:hover, .autocomplete-item.highlighted {
            background: #007bff;
            color: white;
        }
        .checkbox-group label, .radio-group label {
            display: inline-flex;
            align-items: center;
            margin-right: 15px;
            font-weight: normal;
        }
        .checkbox-group input, .radio-group input {
            width: auto;
            margin-right: 5px;
        }
        iframe {
            width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .validation-message {
            color: #dc3545;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        .validation-message.show { display: block; }
        input:invalid { border-color: #dc3545; }
        .range-value {
            display: inline-block;
            min-width: 40px;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div style="margin-bottom: 20px;"><a href="index.html" style="color: #0066cc; text-decoration: none;">&larr; Back to Test Pages</a></div>
    <h1>ðŸ§ª DOM Capabilities Test Page</h1>
    <p>Comprehensive test page for browser extension DOM manipulation capabilities.</p>

    <!-- Event Log -->
    <section>
        <h2>ðŸ“‹ Event Log</h2>
        <div id="eventLog" class="event-log"></div>
        <button class="btn-secondary" onclick="clearLog()">Clear Log</button>
    </section>

    <!-- Standard Input Types -->
    <section>
        <h2>1. Standard Input Types</h2>

        <h3>Text Inputs</h3>
        <div class="component-row">
            <div class="component">
                <label for="text-input">Text</label>
                <input type="text" id="text-input" placeholder="Enter text...">
            </div>
            <div class="component">
                <label for="password-input">Password</label>
                <input type="password" id="password-input" placeholder="Enter password...">
            </div>
            <div class="component">
                <label for="email-input">Email</label>
                <input type="email" id="email-input" placeholder="user@example.com">
            </div>
        </div>

        <div class="component-row">
            <div class="component">
                <label for="tel-input">Telephone</label>
                <input type="tel" id="tel-input" placeholder="+1 (555) 000-0000">
            </div>
            <div class="component">
                <label for="url-input">URL</label>
                <input type="url" id="url-input" placeholder="https://example.com">
            </div>
            <div class="component">
                <label for="search-input">Search</label>
                <input type="search" id="search-input" placeholder="Search...">
            </div>
        </div>

        <h3>Numeric Inputs</h3>
        <div class="component-row">
            <div class="component">
                <label for="number-input">Number (min: 0, max: 100, step: 5)</label>
                <input type="number" id="number-input" min="0" max="100" step="5" value="50">
            </div>
            <div class="component">
                <label for="range-input">Range Slider: <span class="range-value" id="range-value">50</span></label>
                <input type="range" id="range-input" min="0" max="100" value="50">
            </div>
        </div>

        <h3>Date/Time Inputs</h3>
        <div class="component-row">
            <div class="component">
                <label for="date-input">Date</label>
                <input type="date" id="date-input">
            </div>
            <div class="component">
                <label for="time-input">Time</label>
                <input type="time" id="time-input">
            </div>
            <div class="component">
                <label for="datetime-input">DateTime Local</label>
                <input type="datetime-local" id="datetime-input">
            </div>
        </div>

        <div class="component-row">
            <div class="component">
                <label for="month-input">Month</label>
                <input type="month" id="month-input">
            </div>
            <div class="component">
                <label for="week-input">Week</label>
                <input type="week" id="week-input">
            </div>
            <div class="component">
                <label for="color-input">Color</label>
                <input type="color" id="color-input" value="#007bff">
            </div>
        </div>

        <h3>Other Inputs</h3>
        <div class="component-row">
            <div class="component">
                <label for="file-input">File</label>
                <input type="file" id="file-input">
            </div>
        </div>

        <h3>Checkboxes & Radio Buttons</h3>
        <div class="component-row">
            <div class="component">
                <label>Checkboxes</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" id="checkbox-1" name="options"> Option 1</label>
                    <label><input type="checkbox" id="checkbox-2" name="options"> Option 2</label>
                    <label><input type="checkbox" id="checkbox-3" name="options" checked> Option 3</label>
                </div>
            </div>
            <div class="component">
                <label>Radio Buttons</label>
                <div class="radio-group">
                    <label><input type="radio" id="radio-1" name="radio-group" value="a"> Choice A</label>
                    <label><input type="radio" id="radio-2" name="radio-group" value="b"> Choice B</label>
                    <label><input type="radio" id="radio-3" name="radio-group" value="c" checked> Choice C</label>
                </div>
            </div>
        </div>
    </section>

    <!-- Text Areas -->
    <section>
        <h2>2. Text Areas</h2>
        <div class="component-row">
            <div class="component">
                <label for="textarea-standard">Standard Textarea</label>
                <textarea id="textarea-standard" rows="4">Default text content</textarea>
            </div>
            <div class="component">
                <label for="textarea-placeholder">With Placeholder</label>
                <textarea id="textarea-placeholder" rows="4" placeholder="Enter your message here..."></textarea>
            </div>
            <div class="component">
                <label for="textarea-maxlength">With Maxlength (100 chars)</label>
                <textarea id="textarea-maxlength" rows="4" maxlength="100" placeholder="Max 100 characters..."></textarea>
            </div>
        </div>
    </section>

    <!-- Select/Dropdown -->
    <section>
        <h2>3. Select/Dropdown</h2>
        <div class="component-row">
            <div class="component">
                <label for="select-single">Single Select</label>
                <select id="select-single">
                    <option value="">-- Choose --</option>
                    <option value="apple">Apple</option>
                    <option value="banana">Banana</option>
                    <option value="cherry">Cherry</option>
                    <option value="date">Date</option>
                </select>
            </div>
            <div class="component">
                <label for="select-multiple">Multi Select (Ctrl+Click)</label>
                <select id="select-multiple" multiple size="4">
                    <option value="red">Red</option>
                    <option value="green">Green</option>
                    <option value="blue">Blue</option>
                    <option value="yellow">Yellow</option>
                </select>
            </div>
            <div class="component">
                <label for="select-optgroup">With Option Groups</label>
                <select id="select-optgroup">
                    <option value="">-- Choose --</option>
                    <optgroup label="Fruits">
                        <option value="apple">Apple</option>
                        <option value="orange">Orange</option>
                    </optgroup>
                    <optgroup label="Vegetables">
                        <option value="carrot">Carrot</option>
                        <option value="broccoli">Broccoli</option>
                    </optgroup>
                </select>
            </div>
        </div>

        <div class="component-row">
            <div class="component">
                <label for="datalist-input">Datalist (Autocomplete)</label>
                <input type="text" id="datalist-input" list="browsers" placeholder="Type to search...">
                <datalist id="browsers">
                    <option value="Chrome">
                    <option value="Firefox">
                    <option value="Safari">
                    <option value="Edge">
                    <option value="Opera">
                </datalist>
            </div>
        </div>
    </section>

    <!-- Buttons -->
    <section>
        <h2>4. Buttons</h2>
        <div class="component-row">
            <button type="button" class="btn-primary" id="btn-primary">Primary Button</button>
            <button type="button" class="btn-secondary" id="btn-secondary">Secondary Button</button>
            <button type="button" class="btn-success" id="btn-success">Success Button</button>
            <button type="button" class="btn-danger" id="btn-danger">Danger Button</button>
        </div>
        <div class="component-row">
            <form id="button-form" onsubmit="logEvent('Form submitted!'); return false;">
                <button type="submit" class="btn-primary">Submit Button</button>
                <button type="reset" class="btn-secondary">Reset Button</button>
            </form>
        </div>
        <div class="component-row">
            <a href="#" class="btn-primary" style="text-decoration: none; display: inline-block;" id="link-button">Link as Button</a>
        </div>
    </section>

    <!-- ContentEditable -->
    <section>
        <h2>5. ContentEditable Elements</h2>
        <div class="component-row">
            <div class="component">
                <label>Simple ContentEditable</label>
                <div contenteditable="true" id="contenteditable-simple">Click here to edit this text...</div>
            </div>
            <div class="component">
                <label>Rich Text (with formatting)</label>
                <div contenteditable="true" id="contenteditable-rich">
                    <b>Bold</b>, <i>italic</i>, and <u>underlined</u> text.
                </div>
            </div>
        </div>
        <div class="component-row">
            <div class="component">
                <label>Nested ContentEditable</label>
                <div style="border: 1px solid #ddd; padding: 10px; border-radius: 4px;">
                    <p>Non-editable wrapper</p>
                    <div contenteditable="true" id="contenteditable-nested" style="background: #fff;">
                        This inner div is editable
                    </div>
                    <p>More non-editable content</p>
                </div>
            </div>
        </div>
    </section>

    <!-- ARIA Components -->
    <section>
        <h2>6. ARIA Components</h2>
        <div class="component-row">
            <div class="component">
                <label for="aria-textbox">role="textbox"</label>
                <div role="textbox" id="aria-textbox" tabindex="0" contenteditable="true" aria-label="ARIA textbox">
                    ARIA textbox content
                </div>
            </div>
            <div class="component">
                <label for="aria-searchbox">role="searchbox"</label>
                <div role="searchbox" id="aria-searchbox" tabindex="0" contenteditable="true" aria-label="Search">
                    Type to search...
                </div>
            </div>
        </div>

        <div class="component-row">
            <div class="component">
                <label for="aria-combobox">role="combobox" with Arrow Keys</label>
                <div class="autocomplete-wrapper">
                    <input type="text" id="aria-combobox" role="combobox"
                           aria-expanded="false" aria-haspopup="listbox"
                           aria-controls="aria-listbox" autocomplete="off"
                           placeholder="Type city name...">
                    <div id="aria-listbox" role="listbox" class="autocomplete-list">
                        <div role="option" class="autocomplete-item" data-value="new-york">New York</div>
                        <div role="option" class="autocomplete-item" data-value="los-angeles">Los Angeles</div>
                        <div role="option" class="autocomplete-item" data-value="chicago">Chicago</div>
                        <div role="option" class="autocomplete-item" data-value="houston">Houston</div>
                        <div role="option" class="autocomplete-item" data-value="phoenix">Phoenix</div>
                    </div>
                </div>
            </div>
            <div class="component">
                <label for="aria-spinbutton">role="spinbutton"</label>
                <div role="spinbutton" id="aria-spinbutton" tabindex="0"
                     aria-valuenow="5" aria-valuemin="0" aria-valuemax="10"
                     style="border: 1px solid #ddd; padding: 10px; border-radius: 4px; text-align: center;">
                    <button onclick="changeSpinValue(-1)">âˆ’</button>
                    <span id="spin-value">5</span>
                    <button onclick="changeSpinValue(1)">+</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Shadow DOM -->
    <section>
        <h2>7. Shadow DOM</h2>
        <div class="component-row">
            <div class="component">
                <label>Custom Element with Shadow DOM</label>
                <shadow-input id="shadow-input-element"></shadow-input>
            </div>
            <div class="component">
                <label>Nested Shadow DOM</label>
                <nested-shadow id="nested-shadow-element"></nested-shadow>
            </div>
        </div>
    </section>

    <!-- Iframes -->
    <section>
        <h2>8. Iframes</h2>
        <div class="component-row">
            <div class="component">
                <label>Same-Origin Iframe with Form</label>
                <iframe id="iframe-form" srcdoc="
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <style>
                            body { font-family: sans-serif; padding: 15px; margin: 0; }
                            input, textarea { width: 100%; padding: 8px; margin: 5px 0 15px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
                            label { font-weight: bold; }
                            button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
                        </style>
                    </head>
                    <body>
                        <form onsubmit='alert(\"Form submitted!\"); return false;'>
                            <label>Name</label>
                            <input type='text' id='iframe-name' placeholder='Your name'>
                            <label>Email</label>
                            <input type='email' id='iframe-email' placeholder='your@email.com'>
                            <label>Message</label>
                            <textarea id='iframe-message' rows='3' placeholder='Your message...'></textarea>
                            <button type='submit'>Submit</button>
                        </form>
                    </body>
                    </html>
                " style="height: 350px;"></iframe>
            </div>
        </div>
    </section>

    <!-- Framework-like Components -->
    <section>
        <h2>9. Framework-like Components</h2>

        <h3>Controlled Input (React-style)</h3>
        <div class="component-row">
            <div class="component">
                <label for="controlled-input">Controlled Input (state: <span id="controlled-state">""</span>)</label>
                <input type="text" id="controlled-input" placeholder="Type here...">
            </div>
        </div>

        <h3>Input with Validation</h3>
        <div class="component-row">
            <div class="component">
                <label for="validated-input">Username (min 3 chars, alphanumeric only)</label>
                <input type="text" id="validated-input" placeholder="Enter username..." pattern="[a-zA-Z0-9]{3,}">
                <div id="validation-message" class="validation-message">Username must be at least 3 alphanumeric characters</div>
            </div>
        </div>

        <h3>Autocomplete Dropdown (Type + Arrow Keys + Enter)</h3>
        <div class="component-row">
            <div class="component">
                <label for="autocomplete-input">Programming Language</label>
                <div class="autocomplete-wrapper">
                    <input type="text" id="autocomplete-input" placeholder="Type to search..." autocomplete="off">
                    <div id="autocomplete-dropdown" class="autocomplete-list"></div>
                </div>
                <p style="font-size: 12px; color: #666;">Try: type "java", use â†“â†‘ arrows, press Enter to select</p>
            </div>
        </div>
    </section>

    <!-- Edge Cases -->
    <section>
        <h2>10. Edge Cases</h2>

        <h3>Readonly & Disabled</h3>
        <div class="component-row">
            <div class="component">
                <label for="readonly-input">Readonly Input</label>
                <input type="text" id="readonly-input" value="This is readonly" readonly class="readonly">
            </div>
            <div class="component">
                <label for="disabled-input">Disabled Input</label>
                <input type="text" id="disabled-input" value="This is disabled" disabled class="disabled">
            </div>
        </div>

        <h3>Hidden Elements</h3>
        <div class="component-row">
            <div class="component">
                <label>display: none</label>
                <input type="text" id="hidden-display-none" value="hidden by display:none" style="display: none;">
                <p style="font-size: 12px; color: #666;">Input is hidden (display: none)</p>
            </div>
            <div class="component">
                <label>visibility: hidden</label>
                <input type="text" id="hidden-visibility" value="hidden by visibility" style="visibility: hidden; height: 40px;">
                <p style="font-size: 12px; color: #666;">Input is hidden (visibility: hidden)</p>
            </div>
        </div>

        <h3>Form with Submit Handler</h3>
        <div class="component-row">
            <div class="component">
                <form id="submit-form" onsubmit="handleFormSubmit(event)">
                    <label for="submit-input">Press Enter to Submit</label>
                    <input type="text" id="submit-input" placeholder="Type and press Enter...">
                    <p id="submit-message" style="font-size: 12px; color: #28a745; display: none;">âœ“ Form submitted!</p>
                </form>
            </div>
        </div>

        <h3>Input with preventDefault on Enter</h3>
        <div class="component-row">
            <div class="component">
                <label for="prevent-enter-input">Enter Key Blocked</label>
                <input type="text" id="prevent-enter-input" placeholder="Enter key is blocked...">
                <p style="font-size: 12px; color: #666;">This input blocks the Enter key</p>
            </div>
        </div>
    </section>

    <script>
        // Event logging
        function logEvent(message) {
            const log = document.getElementById('eventLog');
            const time = new Date().toLocaleTimeString();
            log.innerHTML += `[${time}] ${message}\n`;
            log.scrollTop = log.scrollHeight;
        }

        function clearLog() {
            document.getElementById('eventLog').innerHTML = '';
        }

        // Add event listeners to all inputs
        document.querySelectorAll('input, textarea, select, [contenteditable], button').forEach(el => {
            ['input', 'change', 'focus', 'blur', 'click', 'keydown'].forEach(eventType => {
                el.addEventListener(eventType, (e) => {
                    const id = e.target.id || e.target.tagName;
                    const value = e.target.value || e.target.textContent?.substring(0, 20) || '';
                    if (eventType === 'keydown') {
                        logEvent(`${eventType}: #${id} key="${e.key}"`);
                    } else if (eventType === 'input' || eventType === 'change') {
                        logEvent(`${eventType}: #${id} value="${value}"`);
                    } else {
                        logEvent(`${eventType}: #${id}`);
                    }
                });
            });
        });

        // Range slider value display
        document.getElementById('range-input').addEventListener('input', (e) => {
            document.getElementById('range-value').textContent = e.target.value;
        });

        // ARIA Combobox
        const combobox = document.getElementById('aria-combobox');
        const listbox = document.getElementById('aria-listbox');
        let highlightedIndex = -1;

        combobox.addEventListener('focus', () => {
            listbox.classList.add('show');
            combobox.setAttribute('aria-expanded', 'true');
        });

        combobox.addEventListener('blur', () => {
            setTimeout(() => {
                listbox.classList.remove('show');
                combobox.setAttribute('aria-expanded', 'false');
            }, 200);
        });

        combobox.addEventListener('keydown', (e) => {
            const items = listbox.querySelectorAll('.autocomplete-item');
            if (e.key === 'ArrowDown') {
                e.preventDefault();
                highlightedIndex = Math.min(highlightedIndex + 1, items.length - 1);
                updateHighlight(items);
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                highlightedIndex = Math.max(highlightedIndex - 1, 0);
                updateHighlight(items);
            } else if (e.key === 'Enter' && highlightedIndex >= 0) {
                e.preventDefault();
                combobox.value = items[highlightedIndex].textContent;
                listbox.classList.remove('show');
                logEvent(`Selected: ${combobox.value}`);
            }
        });

        function updateHighlight(items) {
            items.forEach((item, i) => {
                item.classList.toggle('highlighted', i === highlightedIndex);
            });
        }

        // Spinbutton
        function changeSpinValue(delta) {
            const spinbutton = document.getElementById('aria-spinbutton');
            const valueEl = document.getElementById('spin-value');
            let value = parseInt(spinbutton.getAttribute('aria-valuenow'));
            const min = parseInt(spinbutton.getAttribute('aria-valuemin'));
            const max = parseInt(spinbutton.getAttribute('aria-valuemax'));
            value = Math.max(min, Math.min(max, value + delta));
            spinbutton.setAttribute('aria-valuenow', value);
            valueEl.textContent = value;
            logEvent(`Spinbutton value: ${value}`);
        }

        // Shadow DOM components
        class ShadowInput extends HTMLElement {
            constructor() {
                super();
                const shadow = this.attachShadow({ mode: 'open' });
                shadow.innerHTML = `
                    <style>
                        input {
                            width: 100%;
                            padding: 10px;
                            border: 1px solid #ddd;
                            border-radius: 4px;
                            font-size: 14px;
                        }
                        input:focus {
                            outline: none;
                            border-color: #007bff;
                        }
                    </style>
                    <input type="text" id="shadow-inner-input" placeholder="Input inside Shadow DOM">
                `;
            }
        }
        customElements.define('shadow-input', ShadowInput);

        class NestedShadow extends HTMLElement {
            constructor() {
                super();
                const shadow = this.attachShadow({ mode: 'open' });
                shadow.innerHTML = `
                    <style>
                        .wrapper { border: 1px solid #ddd; padding: 10px; border-radius: 4px; }
                    </style>
                    <div class="wrapper">
                        <p>Outer shadow DOM</p>
                        <inner-shadow></inner-shadow>
                    </div>
                `;
            }
        }

        class InnerShadow extends HTMLElement {
            constructor() {
                super();
                const shadow = this.attachShadow({ mode: 'open' });
                shadow.innerHTML = `
                    <style>
                        input {
                            width: 100%;
                            padding: 8px;
                            border: 1px solid #ccc;
                            border-radius: 4px;
                        }
                    </style>
                    <input type="text" id="nested-shadow-input" placeholder="Nested shadow DOM input">
                `;
            }
        }
        customElements.define('inner-shadow', InnerShadow);
        customElements.define('nested-shadow', NestedShadow);

        // Controlled input (React-style)
        const controlledInput = document.getElementById('controlled-input');
        const controlledState = document.getElementById('controlled-state');
        let state = '';

        controlledInput.addEventListener('input', (e) => {
            state = e.target.value.toUpperCase(); // Transform: uppercase
            controlledState.textContent = `"${state}"`;
            e.target.value = state; // Re-set value like React does
        });

        // Validated input
        const validatedInput = document.getElementById('validated-input');
        const validationMessage = document.getElementById('validation-message');

        validatedInput.addEventListener('input', (e) => {
            const isValid = /^[a-zA-Z0-9]{3,}$/.test(e.target.value);
            validationMessage.classList.toggle('show', !isValid && e.target.value.length > 0);
        });

        // Autocomplete dropdown
        const autocompleteInput = document.getElementById('autocomplete-input');
        const autocompleteDropdown = document.getElementById('autocomplete-dropdown');
        const languages = ['JavaScript', 'Java', 'Python', 'TypeScript', 'Ruby', 'Go', 'Rust', 'C++', 'C#', 'PHP', 'Swift', 'Kotlin'];
        let acHighlightedIndex = -1;
        let filteredLanguages = [];

        autocompleteInput.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            filteredLanguages = languages.filter(lang => lang.toLowerCase().includes(query));
            acHighlightedIndex = -1;

            if (query && filteredLanguages.length) {
                autocompleteDropdown.innerHTML = filteredLanguages.map(lang =>
                    `<div class="autocomplete-item">${lang}</div>`
                ).join('');
                autocompleteDropdown.classList.add('show');
            } else {
                autocompleteDropdown.classList.remove('show');
            }
        });

        autocompleteInput.addEventListener('keydown', (e) => {
            const items = autocompleteDropdown.querySelectorAll('.autocomplete-item');
            if (!items.length) return;

            if (e.key === 'ArrowDown') {
                e.preventDefault();
                acHighlightedIndex = Math.min(acHighlightedIndex + 1, items.length - 1);
                items.forEach((item, i) => item.classList.toggle('highlighted', i === acHighlightedIndex));
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                acHighlightedIndex = Math.max(acHighlightedIndex - 1, 0);
                items.forEach((item, i) => item.classList.toggle('highlighted', i === acHighlightedIndex));
            } else if (e.key === 'Enter' && acHighlightedIndex >= 0) {
                e.preventDefault();
                autocompleteInput.value = filteredLanguages[acHighlightedIndex];
                autocompleteDropdown.classList.remove('show');
                logEvent(`Autocomplete selected: ${autocompleteInput.value}`);
            } else if (e.key === 'Escape') {
                autocompleteDropdown.classList.remove('show');
            }
        });

        autocompleteDropdown.addEventListener('click', (e) => {
            if (e.target.classList.contains('autocomplete-item')) {
                autocompleteInput.value = e.target.textContent;
                autocompleteDropdown.classList.remove('show');
                logEvent(`Autocomplete clicked: ${autocompleteInput.value}`);
            }
        });

        // Form submit handler
        function handleFormSubmit(e) {
            e.preventDefault();
            document.getElementById('submit-message').style.display = 'block';
            logEvent('Form submitted via Enter key!');
            setTimeout(() => {
                document.getElementById('submit-message').style.display = 'none';
            }, 2000);
        }

        // Prevent Enter key
        document.getElementById('prevent-enter-input').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                logEvent('Enter key was blocked!');
            }
        });

        // Initial log
        logEvent('Test page loaded. Interact with components to see events.');
    </script>
</body>
</html>
